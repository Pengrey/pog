{# ═══════════════════════════════════════════════════════════════════════
   pog – Security Assessment Report Template
   ─────────────────────────────────────────────────────────────────────
   This file is a MiniJinja template (Jinja2-compatible) that describes
   the structure of the PDF report via a set of #! directives.

   Directives
   ──────────
     #! title <text>               Large title with accent bar
     #! subtitle <text>            Smaller gray subtitle
     #! section <text>             Section heading with accent underline
     #! finding <severity> <text>  Finding card (auto page-break between findings)
     #! meta <key>: <value>        Key–value metadata line
     #! table                      Table (pipe-delimited, first row = header)
     #! index                      Auto-generated TOC with page numbers & bookmarks
     #! spacer <mm>                Explicit vertical spacing
     #! comment <text>             Template-only note (not rendered in PDF)
     #! image <path>               Include an image (path relative to template)
     #! pagebreak                  Force a new page
     #! hr                         Horizontal rule
     (plain text)                  Markdown-aware paragraph — supports:
                                     **bold**, *italic*, ***bold-italic***,
                                     `inline code`, ```fenced code blocks```,
                                     [link text](url), # headings, - bullet lists

   Available variables
   ───────────────────
     findings  – list of finding objects
     date      – report generation date
     asset     – asset name (required)
     from / to – date range (required)
     total, critical, high, medium, low, info – counts

   Each finding: num, title, severity, asset, date, location,
                 description, status, images
   ═══════════════════════════════════════════════════════════════════════ #}

{# ─────────────────────────────────────────────────────────────────────
   COVER PAGE
   ───────────────────────────────────────────────────────────────────── #}

#! title Security Assessment Report

#! subtitle {{ asset }}

#! spacer 8

#! meta Prepared for: {{ asset }}
#! meta Assessment Period: {{ from }} – {{ to }}
#! meta Report Generated: {{ date }}
#! meta Classification: Confidential

#! spacer 6

This report presents the findings of the security assessment conducted against {{ asset }} during the period {{ from }} to {{ to }}. All identified vulnerabilities have been categorised by severity and include recommended remediation steps where applicable.

#! pagebreak

{# ─────────────────────────────────────────────────────────────────────
   TABLE OF CONTENTS
   ───────────────────────────────────────────────────────────────────── #}

#! subtitle Table of Contents

#! spacer 4

#! index

#! pagebreak

{# ─────────────────────────────────────────────────────────────────────
   EXECUTIVE SUMMARY
   ───────────────────────────────────────────────────────────────────── #}

#! section Executive Summary

This assessment of {{ asset }} identified a total of {{ total }} security finding(s) across the evaluation period ({{ from }} to {{ to }}). The table below provides a breakdown by severity level.

{% if critical > 0 %}
ATTENTION — {{ critical }} critical-severity finding(s) were identified that pose an immediate risk to the confidentiality, integrity, or availability of the target system. These should be prioritised for remediation without delay.
{% endif %}

{% if high > 0 %}
Additionally, {{ high }} high-severity finding(s) were identified that represent a significant risk and should be addressed in the short term.
{% endif %}

#! spacer 4

#! table
Severity | Count | Risk Level
Critical | {{ critical }} | Immediate remediation required
High | {{ high }} | Short-term remediation recommended
Medium | {{ medium }} | Planned remediation advised
Low | {{ low }} | Address during regular maintenance
Info | {{ info }} | Informational / best practice

#! spacer 4

#! table
Metric | Value
Total Findings | {{ total }}
Assessment Period | {{ from }} – {{ to }}
Report Date | {{ date }}

#! pagebreak

{# ─────────────────────────────────────────────────────────────────────
   SCOPE & METHODOLOGY
   ───────────────────────────────────────────────────────────────────── #}

#! section Scope and Methodology

The assessment targeted the asset identified as {{ asset }}. Testing was performed during the window {{ from }} through {{ to }} and included both automated scanning and manual analysis techniques.

#! comment TODO: Add methodology-specific details for your organisation.
#! comment       For example: OWASP Testing Guide, PTES, NIST SP 800-115.

Findings are classified using a five-tier severity model:

#! table
Severity | Description
Critical | Exploitation is trivial and leads to full system compromise, data breach, or service disruption
High | Exploitation is likely and results in significant impact to security posture
Medium | Exploitation requires specific conditions but could result in meaningful impact
Low | Limited impact; exploitation is difficult or requires significant prerequisites
Info | Informational observation or defence-in-depth recommendation

#! spacer 4

All findings include a description, the affected location, the current remediation status, and contextual details where relevant.

#! pagebreak

{# ─────────────────────────────────────────────────────────────────────
   FINDINGS OVERVIEW
   ───────────────────────────────────────────────────────────────────── #}

#! section Findings Overview

The following table provides a high-level summary of all findings identified during the assessment.

#! spacer 4

#! table
# | Severity | Title | Status
{% for f in findings %}
{{ f.num }} | {{ f.severity }} | {{ f.title }} | {{ f.status }}
{% endfor %}

#! pagebreak

{# ─────────────────────────────────────────────────────────────────────
   DETAILED FINDINGS
   ───────────────────────────────────────────────────────────────────── #}

#! section Detailed Findings

#! comment TODO: Consider adding your company logo as a watermark
#! comment       once image support is available.

{% for f in findings %}
#! finding {{ f.severity }} {{ f.num }}. {{ f.title }}

#! meta Location: {{ f.location }}

{{ f.description }}

{% endfor %}

#! pagebreak

{# ─────────────────────────────────────────────────────────────────────
   CONCLUSION
   ───────────────────────────────────────────────────────────────────── #}

#! section Conclusion

This report has documented {{ total }} finding(s) across the assessed target {{ asset }}. The severity distribution is summarised below:

#! spacer 4

#! table
Severity | Count
Critical | {{ critical }}
High | {{ high }}
Medium | {{ medium }}
Low | {{ low }}
Info | {{ info }}

#! spacer 4

{% if critical > 0 or high > 0 %}
Findings rated Critical or High should be addressed as a priority. A reassessment is recommended following remediation to verify that identified issues have been resolved effectively.
{% else %}
No critical or high severity findings were identified. Nonetheless, all findings should be reviewed and addressed according to the organisation's risk management procedures.
{% endif %}

#! spacer 6

#! comment TODO: Add company logo / signature block once image support is implemented
#! comment       #! image ./assets/signature.png

#! hr

#! spacer 2

This report is confidential and intended solely for the named recipient. Redistribution without authorisation is prohibited.
